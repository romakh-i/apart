{"ast":null,"code":"module.exports = runParallel;\n\nfunction runParallel(tasks, cb) {\n  var results, pending, keys;\n  var isSync = true;\n\n  if (Array.isArray(tasks)) {\n    results = [];\n    pending = tasks.length;\n  } else {\n    keys = Object.keys(tasks);\n    results = {};\n    pending = keys.length;\n  }\n\n  function done(err) {\n    function end() {\n      if (cb) cb(err, results);\n      cb = null;\n    }\n\n    if (isSync) process.nextTick(end);else end();\n  }\n\n  function each(i, err, result) {\n    results[i] = result;\n\n    if (--pending === 0 || err) {\n      done(err);\n    }\n  }\n\n  if (!pending) {\n    // empty\n    done(null);\n  } else if (keys) {\n    // object\n    keys.forEach(function (key) {\n      tasks[key](function (err, result) {\n        each(key, err, result);\n      });\n    });\n  } else {\n    // array\n    tasks.forEach(function (task, i) {\n      task(function (err, result) {\n        each(i, err, result);\n      });\n    });\n  }\n\n  isSync = false;\n}","map":null,"metadata":{},"sourceType":"script"}