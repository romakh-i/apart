{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar getFileTypeIcon = require('../utils/getFileTypeIcon');\n\nvar FilePreview = require('./FilePreview');\n\nvar ignoreEvent = require('../utils/ignoreEvent.js');\n\nvar _require = require('preact'),\n    h = _require.h,\n    Component = _require.Component;\n\nvar FileCard = function (_Component) {\n  _inherits(FileCard, _Component);\n\n  function FileCard(props) {\n    _classCallCheck(this, FileCard);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.meta = {};\n    _this.tempStoreMetaOrSubmit = _this.tempStoreMetaOrSubmit.bind(_this);\n    _this.renderMetaFields = _this.renderMetaFields.bind(_this);\n    _this.handleSave = _this.handleSave.bind(_this);\n    _this.handleCancel = _this.handleCancel.bind(_this);\n    return _this;\n  }\n\n  FileCard.prototype.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    setTimeout(function () {\n      if (!_this2.firstInput) return;\n\n      _this2.firstInput.focus({\n        preventScroll: true\n      });\n    }, 150);\n  };\n\n  FileCard.prototype.tempStoreMetaOrSubmit = function tempStoreMetaOrSubmit(ev) {\n    var file = this.props.files[this.props.fileCardFor];\n\n    if (ev.keyCode === 13) {\n      ev.stopPropagation();\n      ev.preventDefault();\n      this.props.saveFileCard(this.meta, file.id);\n      return;\n    }\n\n    var value = ev.target.value;\n    var name = ev.target.dataset.name;\n    this.meta[name] = value;\n  };\n\n  FileCard.prototype.renderMetaFields = function renderMetaFields(file) {\n    var _this3 = this;\n\n    var metaFields = this.props.metaFields || [];\n    return metaFields.map(function (field, i) {\n      return h('fieldset', {\n        'class': 'uppy-DashboardFileCard-fieldset'\n      }, h('label', {\n        'class': 'uppy-DashboardFileCard-label'\n      }, field.name), h('input', {\n        'class': 'uppy-c-textInput uppy-DashboardFileCard-input',\n        type: 'text',\n        'data-name': field.id,\n        value: file.meta[field.id],\n        placeholder: field.placeholder,\n        onkeyup: _this3.tempStoreMetaOrSubmit,\n        onkeydown: _this3.tempStoreMetaOrSubmit,\n        onkeypress: _this3.tempStoreMetaOrSubmit,\n        ref: function ref(el) {\n          if (i === 0) _this3.firstInput = el;\n        }\n      }));\n    });\n  };\n\n  FileCard.prototype.handleSave = function handleSave(ev) {\n    var fileID = this.props.fileCardFor;\n    this.props.saveFileCard(this.meta, fileID);\n  };\n\n  FileCard.prototype.handleCancel = function handleCancel(ev) {\n    this.meta = {};\n    this.props.toggleFileCard();\n  };\n\n  FileCard.prototype.render = function render() {\n    var file = this.props.files[this.props.fileCardFor];\n    return h('div', {\n      'class': 'uppy-DashboardFileCard',\n      onDragOver: ignoreEvent,\n      onDragLeave: ignoreEvent,\n      onDrop: ignoreEvent,\n      onPaste: ignoreEvent\n    }, h('div', {\n      'class': 'uppy-DashboardContent-bar'\n    }, h('div', {\n      'class': 'uppy-DashboardContent-title',\n      role: 'heading',\n      'aria-level': 'h1'\n    }, this.props.i18nArray('editing', {\n      file: h('span', {\n        'class': 'uppy-DashboardContent-titleFile'\n      }, file.meta ? file.meta.name : file.name)\n    })), h('button', {\n      'class': 'uppy-DashboardContent-back',\n      type: 'button',\n      title: this.props.i18n('finishEditingFile'),\n      onclick: this.handleSave\n    }, this.props.i18n('done'))), h('div', {\n      'class': 'uppy-DashboardFileCard-inner'\n    }, h('div', {\n      'class': 'uppy-DashboardFileCard-preview',\n      style: {\n        backgroundColor: getFileTypeIcon(file.type).color\n      }\n    }, h(FilePreview, {\n      file: file\n    })), h('div', {\n      'class': 'uppy-DashboardFileCard-info'\n    }, this.renderMetaFields(file)), h('div', {\n      'class': 'uppy-Dashboard-actions'\n    }, h('button', {\n      'class': 'uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-actionsBtn',\n      type: 'button',\n      onclick: this.handleSave\n    }, this.props.i18n('saveChanges')), h('button', {\n      'class': 'uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-actionsBtn',\n      type: 'button',\n      onclick: this.handleCancel\n    }, this.props.i18n('cancel')))));\n  };\n\n  return FileCard;\n}(Component);\n\nmodule.exports = FileCard;","map":null,"metadata":{},"sourceType":"script"}